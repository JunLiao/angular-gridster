/*
 * angular-gridster
 * http://manifestwebdesign.github.io/angular-gridster
 *
 * @version: 0.11.7
 * @license: MIT
 */
"use strict";!function(a){a.module("gridster",[])}(angular),angular.module("gridster").constant("gridsterConfig",{columns:6,pushing:!0,floating:!0,swapping:!1,width:"auto",colWidth:"auto",rowHeight:"match",margins:[10,10],outerMargin:!0,isMobile:!1,mobileBreakPoint:600,mobileModeEnabled:!0,minColumns:1,minRows:1,maxRows:100,defaultSizeX:2,defaultSizeY:1,minSizeX:1,maxSizeX:null,minSizeY:1,maxSizeY:null,saveGridItemCalculatedHeightInMobile:!1,resizable:{enabled:!0,handles:["s","e","n","w","se","ne","sw","nw"]},draggable:{enabled:!0,scrollSensitivity:20,scrollSpeed:15}}),angular.module("gridster").controller("GridsterCtrl",["gridsterConfig","$timeout",function(a,b){var c=this;angular.extend(this,a),this.resizable=angular.extend({},a.resizable||{}),this.draggable=angular.extend({},a.draggable||{});var d=!1;this.layoutChanged=function(){d||(d=!0,b(function(){d=!1,c.loaded&&c.floatItemsUp(),c.updateHeight(c.movingItem?c.movingItem.sizeY:0)}))},this.grid=[],this.destroy=function(){this.grid&&(this.grid.length=0,this.grid=null)},this.setOptions=function(a){if(a)if(a=angular.extend({},a),a.draggable&&(angular.extend(this.draggable,a.draggable),delete a.draggable),a.resizable&&(angular.extend(this.resizable,a.resizable),delete a.resizable),angular.extend(this,a),this.margins&&2===this.margins.length)for(var b=0,c=this.margins.length;c>b;++b)this.margins[b]=parseInt(this.margins[b],10),isNaN(this.margins[b])&&(this.margins[b]=0);else this.margins=[0,0]},this.canItemOccupy=function(a,b,c){return b>-1&&c>-1&&a.sizeX+c<=this.columns&&a.sizeY+b<=this.maxRows},this.autoSetItemPosition=function(a){for(var b=0;b<this.maxRows;++b)for(var c=0;c<this.columns;++c){var d=this.getItems(b,c,a.sizeX,a.sizeY,a);if(0===d.length&&this.canItemOccupy(a,b,c))return void this.putItem(a,b,c)}throw new Error("Unable to place item!")},this.getItems=function(a,b,c,d,e){var f=[];c&&d||(c=d=1),!e||e instanceof Array||(e=[e]);for(var g=0;d>g;++g)for(var h=0;c>h;++h){var i=this.getItem(a+g,b+h,e);!i||e&&-1!==e.indexOf(i)||-1!==f.indexOf(i)||f.push(i)}return f},this.getBoundingBox=function(a){if(0===a.length)return null;if(1===a.length)return{row:a[0].row,col:a[0].col,sizeY:a[0].sizeY,sizeX:a[0].sizeX};for(var b=0,c=0,d=9999,e=9999,f=0,g=a.length;g>f;++f){var h=a[f];d=Math.min(h.row,d),e=Math.min(h.col,e),b=Math.max(h.row+h.sizeY,b),c=Math.max(h.col+h.sizeX,c)}return{row:d,col:e,sizeY:b-d,sizeX:c-e}},this.removeItem=function(a){for(var b=0,c=this.grid.length;c>b;++b){var d=this.grid[b];if(d){var e=d.indexOf(a);if(-1!==e){d[e]=null;break}}}this.layoutChanged()},this.getItem=function(a,b,c){!c||c instanceof Array||(c=[c]);for(var d=1;a>-1;){for(var e=1,f=b;f>-1;){var g=this.grid[a];if(g){var h=g[f];if(h&&(!c||-1===c.indexOf(h))&&h.sizeX>=e&&h.sizeY>=d)return h}++e,--f}--a,++d}return null},this.putItems=function(a){for(var b=0,c=a.length;c>b;++b)this.putItem(a[b])},this.putItem=function(a,b,c,d){if(("undefined"==typeof b||null===b)&&(b=a.row,c=a.col,"undefined"==typeof b||null===b))return void this.autoSetItemPosition(a);if(this.canItemOccupy(a,b,c)||(c=Math.min(this.columns-a.sizeX,Math.max(0,c)),b=Math.min(this.maxRows-a.sizeY,Math.max(0,b))),null!==a.oldRow&&"undefined"!=typeof a.oldRow){var e=a.oldRow===b&&a.oldColumn===c,f=this.grid[b]&&this.grid[b][c]===a;if(e&&f)return a.row=b,void(a.col=c);var g=this.grid[a.oldRow];g&&g[a.oldColumn]===a&&delete g[a.oldColumn]}a.oldRow=a.row=b,a.oldColumn=a.col=c,this.moveOverlappingItems(a,d),this.grid[b]||(this.grid[b]=[]),this.grid[b][c]=a,this.movingItem===a&&this.floatItemUp(a),this.layoutChanged()},this.swapItems=function(a,b){this.grid[a.row][a.col]=b,this.grid[b.row][b.col]=a;var c=a.row,d=a.col;a.row=b.row,a.col=b.col,b.row=c,b.col=d},this.moveOverlappingItems=function(a,b){b?-1===b.indexOf(a)&&(b=b.slice(0),b.push(a)):b=[a];var c=this.getItems(a.row,a.col,a.sizeX,a.sizeY,b);this.moveItemsDown(c,a.row+a.sizeY,b)},this.moveItemsDown=function(a,b,c){if(a&&0!==a.length){a.sort(function(a,b){return a.row-b.row}),c=c?c.slice(0):[];var d,e,f,g={};for(e=0,f=a.length;f>e;++e){d=a[e];var h=g[d.col];("undefined"==typeof h||d.row<h)&&(g[d.col]=d.row)}for(e=0,f=a.length;f>e;++e){d=a[e];var i=b-g[d.col];this.moveItemDown(d,d.row+i,c),c.push(d)}}},this.moveItemDown=function(a,b,c){if(!(a.row>=b)){for(;a.row<b;)++a.row,this.moveOverlappingItems(a,c);this.putItem(a,a.row,a.col,c)}},this.floatItemsUp=function(){if(this.floating!==!1)for(var a=0,b=this.grid.length;b>a;++a){var c=this.grid[a];if(c)for(var d=0,e=c.length;e>d;++d){var f=c[d];f&&this.floatItemUp(f)}}},this.floatItemUp=function(a){if(this.floating!==!1){for(var b,c=a.col,d=a.sizeY,e=a.sizeX,f=null,g=null,h=a.row-1;h>-1&&(b=this.getItems(h,c,e,d,a),0===b.length);)f=h,g=c,--h;null!==f&&this.putItem(a,f,g)}},this.updateHeight=function(a){var b=this.minRows;a=a||0;for(var c=this.grid.length;c>=0;--c){var d=this.grid[c];if(d)for(var e=0,f=d.length;f>e;++e)d[e]&&(b=Math.max(b,c+a+d[e].sizeY))}this.gridHeight=this.maxRows-b>0?Math.min(this.maxRows,b):Math.max(this.maxRows,b)},this.pixelsToRows=function(a,b){return b===!0?Math.ceil(a/this.curRowHeight):b===!1?Math.floor(a/this.curRowHeight):Math.round(a/this.curRowHeight)},this.pixelsToColumns=function(a,b){return b===!0?Math.ceil(a/this.curColWidth):b===!1?Math.floor(a/this.curColWidth):Math.round(a/this.curColWidth)},this.unifiedInput=function(a,b,c,d){var e,f,g={},h=function(a){if(Object.keys)return Object.keys(a).length;var b,c=0;for(b in a)++c;return c},i=function(a){for(var b=0,c=0,d=navigator.userAgent.match(/\bMSIE\b/),e=a;null!=e;e=e.offsetParent)d&&(!document.documentMode||document.documentMode<8)&&"relative"===e.currentStyle.position&&e.offsetParent&&"relative"===e.offsetParent.currentStyle.position&&e.offsetLeft===e.offsetParent.offsetLeft?c+=e.offsetTop:(b+=e.offsetLeft,c+=e.offsetTop);return{x:b,y:c}},j=i(a),k=function(e){if("mousemove"!==e.type||0!==h(g)){for(var f=!0,m=e.changedTouches?e.changedTouches:[e],n=0;n<m.length;++n){var o=m[n],p="undefined"!=typeof o.identifier?o.identifier:"undefined"!=typeof o.pointerId?o.pointerId:1;if("undefined"==typeof o.pageX)if(o.pageX=o.offsetX+j.x,o.pageY=o.offsetY+j.y,o.srcElement.offsetParent===a&&document.documentMode&&8===document.documentMode&&"mousedown"===o.type)o.pageX+=o.srcElement.offsetLeft,o.pageY+=o.srcElement.offsetTop;else if(o.srcElement!==a&&!document.documentMode||document.documentMode<8){for(var q=-2,r=-2,s=o.srcElement;null!==s;s=s.parentNode)q+=s.scrollLeft?s.scrollLeft:0,r+=s.scrollTop?s.scrollTop:0;o.pageX=o.clientX+q,o.pageY=o.clientY+r}var t=o.pageX,u=o.pageY;e.type.match(/(start|down)$/i)?(j=i(a),g[p]&&(d&&d({target:e.target,which:e.which,pointerId:p,pageX:t,pageY:u}),delete g[p]),b&&f&&(f=b({target:e.target,which:e.which,pointerId:p,pageX:t,pageY:u})),g[p]={x:t,y:u},a.msSetPointerCapture?a.msSetPointerCapture(p):"mousedown"===e.type&&1===h(g)&&(l?a.setCapture(!0):(document.addEventListener("mousemove",k,!1),document.addEventListener("mouseup",k,!1)))):e.type.match(/move$/i)?!g[p]||g[p].x===t&&g[p].y===u||(c&&f&&(f=c({target:e.target,which:e.which,pointerId:p,pageX:t,pageY:u})),g[p].x=t,g[p].y=u):g[p]&&e.type.match(/(up|end|cancel)$/i)&&(d&&f&&(f=d({target:e.target,which:e.which,pointerId:p,pageX:t,pageY:u})),delete g[p],a.msReleasePointerCapture?a.msReleasePointerCapture(p):"mouseup"===e.type&&0===h(g)&&(l?a.releaseCapture():(document.removeEventListener("mousemove",k,!1),document.removeEventListener("mouseup",k,!1))))}f&&(e.preventDefault&&e.preventDefault(),e.preventManipulation&&e.preventManipulation(),e.preventMouseEvent&&e.preventMouseEvent())}},l=!1;return this.enable=function(){window.navigator.msPointerEnabled?(a.addEventListener("MSPointerDown",k,!1),a.addEventListener("MSPointerMove",k,!1),a.addEventListener("MSPointerUp",k,!1),a.addEventListener("MSPointerCancel",k,!1),"undefined"!=typeof a.style.msContentZooming&&(e=a.style.msContentZooming,a.style.msContentZooming="none"),"undefined"!=typeof a.style.msTouchAction&&(f=a.style.msTouchAction,a.style.msTouchAction="none")):a.addEventListener?(a.addEventListener("touchstart",k,!1),a.addEventListener("touchmove",k,!1),a.addEventListener("touchend",k,!1),a.addEventListener("touchcancel",k,!1),a.addEventListener("mousedown",k,!1),a.setCapture&&!window.navigator.userAgent.match(/\bGecko\b/)&&(l=!0,a.addEventListener("mousemove",k,!1),a.addEventListener("mouseup",k,!1))):a.attachEvent&&a.setCapture&&(l=!0,a.attachEvent("onmousedown",function(){return k(window.event),window.event.returnValue=!1,!1}),a.attachEvent("onmousemove",function(){return k(window.event),window.event.returnValue=!1,!1}),a.attachEvent("onmouseup",function(){return k(window.event),window.event.returnValue=!1,!1}))},this.disable=function(){window.navigator.msPointerEnabled?(a.removeEventListener("MSPointerDown",k,!1),a.removeEventListener("MSPointerMove",k,!1),a.removeEventListener("MSPointerUp",k,!1),a.removeEventListener("MSPointerCancel",k,!1),e&&(a.style.msContentZooming=e),f&&(a.style.msTouchAction=f)):a.removeEventListener?(a.removeEventListener("touchstart",k,!1),a.removeEventListener("touchmove",k,!1),a.removeEventListener("touchend",k,!1),a.removeEventListener("touchcancel",k,!1),a.removeEventListener("mousedown",k,!1),a.setCapture&&!window.navigator.userAgent.match(/\bGecko\b/)&&(l=!0,a.removeEventListener("mousemove",k,!1),a.removeEventListener("mouseup",k,!1))):a.detachEvent&&a.setCapture&&(l=!0,a.detachEvent("onmousedown"),a.detachEvent("onmousemove"),a.detachEvent("onmouseup"))},this}}]),angular.module("gridster").directive("gridster",["$timeout","$rootScope","$window",function(a,b,c){return{restrict:"EAC",transclude:!0,replace:!0,template:'<div ng-class="gridsterClass()"><div ng-style="previewStyle()" class="gridster-item gridster-preview-holder"></div><div class="gridster-content" ng-transclude></div></div>',controller:"GridsterCtrl",controllerAs:"gridster",scope:{config:"=?gridster"},compile:function(){return function(d,e,f,g){function h(){var a=e[0].offsetWidth||parseInt(e.css("width"),10);a&&a!==l&&!g.movingItem&&(l=a,g.loaded&&e.removeClass("gridster-loaded"),j(),g.loaded&&e.addClass("gridster-loaded"),d.$parent.$broadcast("gridster-resized",[a,e[0].offsetHeight]))}function i(){h(),a(function(){d.$apply()})}g.loaded=!1,d.gridsterClass=function(){return{gridster:!0,"gridster-desktop":!g.isMobile,"gridster-mobile":g.isMobile,"gridster-loaded":g.loaded}},d.previewStyle=function(){return g.movingItem?{display:"block",height:g.movingItem.sizeY*g.curRowHeight-g.margins[0]+"px",width:g.movingItem.sizeX*g.curColWidth-g.margins[1]+"px",top:g.movingItem.row*g.curRowHeight+(g.outerMargin?g.margins[0]:0)+"px",left:g.movingItem.col*g.curColWidth+(g.outerMargin?g.margins[1]:0)+"px"}:{display:"none"}};var j=function(){g.setOptions(d.config),g.curWidth="auto"===g.width?e[0].offsetWidth||parseInt(e.css("width"),10):g.width,g.curColWidth="auto"===g.colWidth?(g.curWidth+(g.outerMargin?-g.margins[1]:g.margins[1]))/g.columns:g.colWidth,g.curRowHeight=g.rowHeight,"string"==typeof g.rowHeight&&("match"===g.rowHeight?g.curRowHeight=Math.round(g.curColWidth):-1!==g.rowHeight.indexOf("*")?g.curRowHeight=Math.round(g.curColWidth*g.rowHeight.replace("*","").replace(" ","")):-1!==g.rowHeight.indexOf("/")&&(g.curRowHeight=Math.round(g.curColWidth/g.rowHeight.replace("/","").replace(" ","")))),g.isMobile=g.mobileModeEnabled&&g.curWidth<=g.mobileBreakPoint;for(var a=0,b=g.grid.length;b>a;++a){var c=g.grid[a];if(c)for(var f=0,h=c.length;h>f;++f)if(c[f]){var i=c[f];i.setElementPosition(),i.setElementSizeY(),i.setElementSizeX()}}k()};d.$watch("config",j,!0),d.$watch("config.draggable",function(){b.$broadcast("gridster-draggable-changed")},!0),d.$watch("config.resizable",function(){b.$broadcast("gridster-resizable-changed")},!0);var k=function(){e.css("height",g.gridHeight*g.curRowHeight+(g.outerMargin?g.margins[0]:-g.margins[0])+"px")};d.$watch("gridster.gridHeight",k),d.$watch("gridster.movingItem",function(){g.updateHeight(g.movingItem?g.movingItem.sizeY:0)});var l=e[0].offsetWidth||parseInt(e.css("width"),10);"function"==typeof e.resize&&e.resize(i);var m=angular.element(c);m.on("resize",i),d.$watch(function(){return e[0].offsetWidth||parseInt(e.css("width"),10)},h),d.$on("$destroy",function(){g.destroy(),m.off("resize",i)}),a(function(){d.$watch("gridster.floating",function(){g.floatItemsUp()}),g.loaded=!0},100)}}}}]),angular.module("gridster").factory("GridsterDraggable",["$document","$timeout","$window",function(a,b,c){function d(d,e,f,g,h){function i(a){if(-1!==F.indexOf(a.target.nodeName.toLowerCase()))return!1;if(angular.element(a.target).hasClass("gridster-item-resizable-handler"))return!1;if(angular.element(a.target).attr("onclick")||angular.element(a.target).attr("ng-click"))return!1;switch(a.which){case 1:break;case 2:case 3:return}return x=a.pageX,y=a.pageY,o=parseInt(d.css("left"),10),p=parseInt(d.css("top"),10),q=d[0].offsetWidth,r=d[0].offsetHeight,s=g.col,t=g.row,l(a),!0}function j(a){if(!d.hasClass("gridster-item-moving")||d.hasClass("gridster-item-resizing"))return!1;var b=f.curWidth-1;v=a.pageX,w=a.pageY;var c=v-x+z,e=w-y+A;z=A=0,x=v,y=w;var g=c,h=e;return D>o+g?(c=D-o,z=g-c):o+q+g>b&&(c=b-o-q,z=g-c),B>p+h?(e=B-p,A=h-e):p+r+h>C&&(e=C-p-r,A=h-e),o+=c,p+=e,d.css({top:p+"px",left:o+"px"}),m(a),!0}function k(a){return!d.hasClass("gridster-item-moving")||d.hasClass("gridster-item-resizing")?!1:(z=A=0,n(a),!0)}function l(a){d.addClass("gridster-item-moving"),f.movingItem=g,f.updateHeight(g.sizeY),e.$apply(function(){f.draggable&&f.draggable.start&&f.draggable.start(a,d,h)})}function m(a){var b=g.row,i=g.col,j=f.draggable&&f.draggable.drag,k=f.draggable.scrollSensitivity,l=f.draggable.scrollSpeed,m=f.pixelsToRows(p),n=f.pixelsToColumns(o),q=f.getItems(m,n,g.sizeX,g.sizeY,g),r=0!==q.length;if(f.swapping===!0&&r){var s=f.getBoundingBox(q),t=s.sizeX===g.sizeX&&s.sizeY===g.sizeY,u=s.row===m,v=s.col===n,w=u&&v,x=u||v;if(t&&1===q.length){if(w)f.swapItems(g,q[0]);else if(x)return}else if(s.sizeX<=g.sizeX&&s.sizeY<=g.sizeY&&x)for(var y=g.row<=m?g.row:m+g.sizeY,z=g.col<=n?g.col:n+g.sizeX,A=y-s.row,B=z-s.col,C=0,D=q.length;D>C;++C){var F=q[C],G=f.getItems(F.row+A,F.col+B,F.sizeX,F.sizeY,g);0===G.length&&f.putItem(F,F.row+A,F.col+B)}}f.pushing===!1&&r||(g.row=m,g.col=n),a.pageY-E.body.scrollTop<k?E.body.scrollTop=E.body.scrollTop-l:c.innerHeight-(a.pageY-E.body.scrollTop)<k&&(E.body.scrollTop=E.body.scrollTop+l),a.pageX-E.body.scrollLeft<k?E.body.scrollLeft=E.body.scrollLeft-l:c.innerWidth-(a.pageX-E.body.scrollLeft)<k&&(E.body.scrollLeft=E.body.scrollLeft+l),(j||b!==g.row||i!==g.col)&&e.$apply(function(){j&&f.draggable.drag(a,d,h)})}function n(a){d.removeClass("gridster-item-moving");var b=f.pixelsToRows(p),c=f.pixelsToColumns(o);(f.pushing!==!1||0===f.getItems(b,c,g.sizeX,g.sizeY,g).length)&&(g.row=b,g.col=c),f.movingItem=null,g.setPosition(g.row,g.col),e.$apply(function(){f.draggable&&f.draggable.stop&&f.draggable.stop(a,d,h)})}var o,p,q,r,s,t,u,v=0,w=0,x=0,y=0,z=0,A=0,B=0,C=9999,D=0,E=a[0],F=["select","input","textarea","button"],G=!1,H=null;this.enable=function(){var a=this;b(function(){a.disable(),f.draggable&&f.draggable.handle?(H=angular.element(d[0].querySelector(f.draggable.handle)),0===H.length&&(H=d)):H=d,u=new f.unifiedInput(H[0],i,j,k),u.enable(),G=!0})},this.disable=function(){G&&(u.disable(),u=void 0,G=!1)},this.toggle=function(a){a?this.enable():this.disable()},this.destroy=function(){this.disable()}}return d}]),angular.module("gridster").factory("GridsterResizable",[function(){function a(a,b,c,d,e){function f(f){function g(e){switch(e.which){case 1:break;case 2:case 3:return}return s=c.draggable.enabled,s&&(c.draggable.enabled=!1,b.$broadcast("gridster-draggable-changed")),x=e.pageX,y=e.pageY,m=parseInt(a.css("left"),10),n=parseInt(a.css("top"),10),o=a[0].offsetWidth,p=a[0].offsetHeight,q=d.sizeX,r=d.sizeY,h(e),!0}function h(f){a.addClass("gridster-item-moving"),a.addClass("gridster-item-resizing"),c.movingItem=d,d.setElementSizeX(),d.setElementSizeY(),d.setElementPosition(),c.updateHeight(1),b.$apply(function(){c.resizable&&c.resizable.start&&c.resizable.start(f,a,e)})}function i(b){var d=c.curWidth-1;v=b.pageX,w=b.pageY;var e=v-x+z,f=w-y+A;z=A=0,x=v,y=w;var g=f,h=e;return u.indexOf("n")>=0&&(p-g<E()?(f=p-E(),A=g-f):B>n+g&&(f=B-n,A=g-f),n+=f,p-=f),u.indexOf("s")>=0&&(p+g<E()?(f=E()-p,A=g-f):n+p+g>C&&(f=C-n-p,A=g-f),p+=f),u.indexOf("w")>=0&&(o-h<F()?(e=o-F(),z=h-e):D>m+h&&(e=D-m,z=h-e),m+=e,o-=e),u.indexOf("e")>=0&&(o+h<F()?(e=F()-o,z=h-e):m+o+h>d&&(e=d-m-o,z=h-e),o+=e),a.css({top:n+"px",left:m+"px",width:o+"px",height:p+"px"}),k(b),!0}function j(a){return c.draggable.enabled!==s&&(c.draggable.enabled=s,b.$broadcast("gridster-draggable-changed")),z=A=0,l(a),!0}function k(g){var h=d.row,i=d.col,j=d.sizeX,k=d.sizeY,l=c.resizable&&c.resizable.resize,q=d.col;-1!==["w","nw","sw"].indexOf(f)&&(q=c.pixelsToColumns(m,!1));var r=d.row;-1!==["n","ne","nw"].indexOf(f)&&(r=c.pixelsToRows(n,!1));var s=d.sizeX;-1===["n","s"].indexOf(f)&&(s=c.pixelsToColumns(o,!0));var t=d.sizeY;-1===["e","w"].indexOf(f)&&(t=c.pixelsToRows(p,!0)),(c.pushing!==!1||0===c.getItems(r,q,s,t,d).length)&&(d.row=r,d.col=q,d.sizeX=s,d.sizeY=t);var u=d.row!==h||d.col!==i||d.sizeX!==j||d.sizeY!==k;(l||u)&&b.$apply(function(){l&&c.resizable.resize(g,a,e)})}function l(f){a.removeClass("gridster-item-moving"),a.removeClass("gridster-item-resizing"),c.movingItem=null,d.setPosition(d.row,d.col),d.setSizeY(d.sizeY),d.setSizeX(d.sizeX),b.$apply(function(){c.resizable&&c.resizable.stop&&c.resizable.stop(f,a,e)})}var m,n,o,p,q,r,s,t,u=f,v=0,w=0,x=0,y=0,z=0,A=0,B=0,C=9999,D=0,E=function(){return c.curRowHeight-c.margins[0]},F=function(){return c.curColWidth-c.margins[1]},G=null;this.enable=function(){G||(G=angular.element('<div class="gridster-item-resizable-handler handle-'+u+'"></div>'),a.append(G)),t=new c.unifiedInput(G[0],g,i,j),t.enable()},this.disable=function(){G&&(G.remove(),G=null),t.disable(),t=void 0},this.destroy=function(){this.disable()}}var g=[],h=c.resizable.handles,i=[],j=[];c.resizable.invalidSizes&&c.resizable.invalidSizes.width&&(i=c.resizable.invalidSizes.width),c.resizable.invalidSizes&&c.resizable.invalidSizes.height&&(j=c.resizable.invalidSizes.height),"string"==typeof h&&(h=c.resizable.handles.split(","));for(var k=!1,l=0,m=h.length;m>l;l++)g.push(new f(h[l]));this.enable=function(){if(!k){for(var a=0,b=g.length;b>a;a++)g[a].enable();k=!0}},this.disable=function(){if(k){for(var a=0,b=g.length;b>a;a++)g[a].disable();k=!1}},this.toggle=function(a){a?this.enable():this.disable()},this.destroy=function(){for(var a=0,b=g.length;b>a;a++)g[a].destroy()}}return a}]),angular.module("gridster").controller("GridsterItemCtrl",function(){this.$element=null,this.gridster=null,this.row=null,this.col=null,this.sizeX=null,this.sizeY=null,this.minSizeX=0,this.minSizeY=0,this.maxSizeX=null,this.maxSizeY=null,this.init=function(a,b){this.$element=a,this.gridster=b,this.sizeX=b.defaultSizeX,this.sizeY=b.defaultSizeY},this.destroy=function(){this.gridster=null,this.$element=null},this.toJSON=function(){return{row:this.row,col:this.col,sizeY:this.sizeY,sizeX:this.sizeX}},this.isMoving=function(){return this.gridster.movingItem===this},this.setPosition=function(a,b){this.gridster.putItem(this,a,b),this.isMoving()||this.setElementPosition()},this.setSize=function(a,b,c){a=a.toUpperCase();var d="size"+a,e="Size"+a;if(""!==b){b=parseInt(b,10),(isNaN(b)||0===b)&&(b=this.gridster["default"+e]);var f="X"===a?this.gridster.columns:this.gridster.maxRows;this["max"+e]&&(f=Math.min(this["max"+e],f)),this.gridster["max"+e]&&(f=Math.min(this.gridster["max"+e],f)),"X"===a&&this.cols?f-=this.cols:"Y"===a&&this.rows&&(f-=this.rows);var g=0;if(this["min"+e]&&(g=Math.max(this["min"+e],g)),this.gridster["min"+e]&&(g=Math.max(this.gridster["min"+e],g)),b=Math.max(Math.min(b,f),g),this.gridster.resizable.invalidSizes){var h=[];if("X"===a?h=this.gridster.resizable.invalidSizes.width:"Y"===a&&(h=this.gridster.resizable.invalidSizes.height),h&&h.length&&h.indexOf(b)>=0)return this[d]=this["old"+e],!1}var i=this[d]!==b||this["old"+e]&&this["old"+e]!==b;return this["old"+e]=this[d]=b,this.isMoving()||this["setElement"+e](),!c&&i&&(this.gridster.moveOverlappingItems(this),this.gridster.layoutChanged()),i}},this.setSizeY=function(a,b){return this.setSize("Y",a,b)},this.setSizeX=function(a,b){return this.setSize("X",a,b)},this.setElementPosition=function(){this.$element.css(this.gridster.isMobile?{marginLeft:this.gridster.margins[0]+"px",marginRight:this.gridster.margins[0]+"px",marginTop:this.gridster.margins[1]+"px",marginBottom:this.gridster.margins[1]+"px",top:"",left:""}:{margin:0,top:this.row*this.gridster.curRowHeight+(this.gridster.outerMargin?this.gridster.margins[0]:0)+"px",left:this.col*this.gridster.curColWidth+(this.gridster.outerMargin?this.gridster.margins[1]:0)+"px"})},this.setElementSizeY=function(){this.gridster.isMobile&&!this.gridster.saveGridItemCalculatedHeightInMobile?this.$element.css("height",""):this.$element.css("height",this.sizeY*this.gridster.curRowHeight-this.gridster.margins[0]+"px")},this.setElementSizeX=function(){this.gridster.isMobile?this.$element.css("width",""):this.$element.css("width",this.sizeX*this.gridster.curColWidth-this.gridster.margins[1]+"px")},this.getElementSizeX=function(){return this.sizeX*this.gridster.curColWidth-this.gridster.margins[1]},this.getElementSizeY=function(){return this.sizeY*this.gridster.curRowHeight-this.gridster.margins[0]}}),angular.module("gridster").directive("gridsterItem",["$parse","GridsterDraggable","GridsterResizable",function(a,b,c){return{restrict:"EA",controller:"GridsterItemCtrl",require:["^gridster","gridsterItem"],link:function(d,e,f,g){function h(){n.setPosition(n.row,n.col),q.row&&q.row.assign&&q.row.assign(d,n.row),q.col&&q.col.assign&&q.col.assign(d,n.col)}function i(){var a=n.setSizeX(n.sizeX,!0);a&&q.sizeX&&q.sizeX.assign&&q.sizeX.assign(d,n.sizeX);var b=n.setSizeY(n.sizeY,!0);b&&q.sizeY&&q.sizeY.assign&&q.sizeY.assign(d,n.sizeY),(a||b)&&(n.gridster.moveOverlappingItems(n),m.layoutChanged())}function j(){var a=document.createElement("div"),b={transition:"transitionend",OTransition:"oTransitionEnd",MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd"};for(var c in b)if(void 0!==a.style[c])return b[c]}var k,l=f.gridsterItem,m=g[0],n=g[1];if(l){var o=a(l);k=o(d)||{},!k&&o.assign&&(k={row:n.row,col:n.col,sizeX:n.sizeX,sizeY:n.sizeY,minSizeX:0,minSizeY:0,maxSizeX:null,maxSizeY:null,resizable:!1,draggable:!1},o.assign(d,k))}else k=f;void 0===k.resizable&&(k.resizable=m.resizable.enabled),void 0===k.draggable&&(k.draggable=m.draggable.enabled),n.init(e,m),e.addClass("gridster-item");for(var p=["minSizeX","maxSizeX","minSizeY","maxSizeY","sizeX","sizeY","row","col","resizable","draggable"],q={},r=function(b){var c;if("string"==typeof k[b])c=k[b];else if("string"==typeof k[b.toLowerCase()]||"boolean"==typeof k[b.toLowerCase()])c=k[b.toLowerCase()];else{if(!l)return;c=a(l+"."+b)}q[b]=a(c),d.$watch(c,function(a){a=parseInt(a,10),isNaN(a)||(n[b]=a)});var e=q[b](d);("number"==typeof e||"boolean"==typeof e)&&(n[b]=e)},s=0,t=p.length;t>s;++s)r(p[s]);void 0===n.resizable&&(n.resizable=void 0===k.resizable?m.resizable.enabled:k.resizable),void 0===n.draggable&&(n.draggable=void 0===k.draggable?m.draggable.enabled:k.draggable),d.$broadcast("gridster-item-initialized",[n.sizeY,n.sizeX,n.getElementSizeY(),n.getElementSizeX()]),d.$watch(function(){return n.row+","+n.col},h),d.$watch(function(){return n.sizeY+","+n.sizeX+"|"+n.minSizeX+","+n.maxSizeX+","+n.minSizeY+","+n.maxSizeY},i);var u=new b(e,d,m,n,k),v=new c(e,d,m,n,k);return d.$on("gridster-draggable-changed",function(){u.toggle(!m.isMobile&&m.draggable&&m.draggable.enabled&&n.draggable)}),d.$on("gridster-resizable-changed",function(){v.toggle(!m.isMobile&&m.resizable&&m.resizable.enabled&&n.resizable)}),d.$on("gridster-resized",function(){v.toggle(!m.isMobile&&m.resizable&&m.resizable.enabled&&n.resizable)}),d.$watch(function(){return m.isMobile},function(){v.toggle(!m.isMobile&&m.resizable&&m.resizable.enabled&&n.resizable),u.toggle(!m.isMobile&&m.draggable&&m.draggable.enabled&&n.draggable)}),e.on(j(),function(){d.$apply(function(){d.$broadcast("gridster-item-transition-end")})}),d.$on("$destroy",function(){try{v.destroy(),u.destroy()}catch(a){}try{m.removeItem(n)}catch(a){}try{n.destroy()}catch(a){}})}}}]);